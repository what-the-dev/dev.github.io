


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://what-the-dev.github.io/dev.github.io/fastai%20deep%20learning%202020/lesson%2003%20pt%201/">
      
      
        <meta name="author" content="Devin de Araujo <devindearaujo@gmail.com>">
      
      <link rel="shortcut icon" href="../../images/dda.svg">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Lesson 03 pt 1 - devin de araujo</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.b5d04df8.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9ab2c1f8.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lesson-3-under-the-hood-training-a-digit-classifier" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://what-the-dev.github.io/dev.github.io/" title="devin de araujo" class="md-header-nav__button md-logo" aria-label="devin de araujo">
      
  <img src="../../images/dda.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            devin de araujo
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Lesson 03 pt 1
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/what-the-dev/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://what-the-dev.github.io/dev.github.io/" title="devin de araujo" class="md-nav__button md-logo" aria-label="devin de araujo">
      
  <img src="../../images/dda.svg" alt="logo">

    </a>
    devin de araujo
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/what-the-dev/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Fastai deep learning 2020
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Fastai deep learning 2020" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Fastai deep learning 2020
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lesson%2001/" title="Lesson 01" class="md-nav__link">
      Lesson 01
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lesson%2002/" title="Lesson 02" class="md-nav__link">
      Lesson 02
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Lesson 03 pt 1
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Lesson 03 pt 1" class="md-nav__link md-nav__link--active">
      Lesson 03 pt 1
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#primer" class="md-nav__link">
    Primer
  </a>
  
    <nav class="md-nav" aria-label="Primer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualising-data" class="md-nav__link">
    Visualising Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidebar-think-about-the-problem" class="md-nav__link">
    Sidebar - think about the problem
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lesson%2003%20pt%202/" title="Lesson 03 pt 2" class="md-nav__link">
      Lesson 03 pt 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lesson%2004/" title="Lesson 04" class="md-nav__link">
      Lesson 04
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#primer" class="md-nav__link">
    Primer
  </a>
  
    <nav class="md-nav" aria-label="Primer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualising-data" class="md-nav__link">
    Visualising Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidebar-think-about-the-problem" class="md-nav__link">
    Sidebar - think about the problem
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/what-the-dev/edit/master/docs/fastai deep learning 2020/lesson 03 pt 1.ipynb" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="lesson-3-under-the-hood-training-a-digit-classifier">Lesson 3: Under the Hood: Training a Digit Classifier</h1>
<p><strong>20-09-2020</strong></p>
<p>This notebook will go over <em>some</em> of the practical material discussed in <a href="https://course.fast.ai/videos/?lesson=1">lesson 3</a> of the fastai 2020 course, namely, some different ways of training a digit classifier using the MNIST data set.
</div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="primer">Primer</h2>
<ul>
<li>load in some data</li>
<li>visualise it
</div>
</div></li>
</ul>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</code></pre></div>


</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
For this model we are going to create a digit classifier that will be able to classify an image as a 3 or a 7. Fastai has a sample of the MNIST dataset that we will be using.</p>
<p>First, let's load the data and check that there are indeed, 3's an 7's in one of the folders. The folder layout is fairly typical, separate training and validation sets.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>
</code></pre></div>


</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(#2) [Path(&#39;/storage/data/mnist_sample/train/7&#39;),Path(&#39;/storage/data/mnist_sample/train/3&#39;)]</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="visualising-data">Visualising Data</h3>
<p>There are a number of ways we can check our data to get a better understanding of how it is structured and how it looks</p>
<ol>
<li>Take a look inside one of the folders and check file names</li>
<li>Use PIL to open one of the images</li>
<li>Use PyTorch/Numpy to check the tensor/array values</li>
<li>Get creative
</div>
</div></li>
</ol>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 1 - check file names</span>
<span class="n">threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">threes</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(#6131) [Path(&#39;/storage/data/mnist_sample/train/3/10.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10000.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10011.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10031.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10034.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10042.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10052.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/1007.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10074.png&#39;),Path(&#39;/storage/data/mnist_sample/train/3/10091.png&#39;)...]</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 2 - use PIL to open image</span>
<span class="n">im3_path</span> <span class="o">=</span> <span class="n">threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im3_path</span><span class="p">)</span>
<span class="n">im3</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAA9ElEQVR4nM3Or0sDcRjH8c/pgrfBVBjCgibThiKIyTWbWF1bORhGwxARxH/AbtW0JoIGwzXRYhJhtuFY2q1ocLgbe3sGReTuuWbwkx6+r+/zQ/pncX6q+YOldSe6nG3dn8U/rTQ70L8FCGJUewvxl7NTmezNb8xIkvKugr1HSeMP6SrWOVkoTEuSyh0Gm2n3hQyObMnXnxkempRrvgD+gokzwxFAr7U7YXHZ8x4A/Dl7rbu6D2yl3etcw/F3nZgfRVI7rXM7hMUUqzzBec427x26rkmlkzEEa4nnRqnSOH2F0UUx0ePzlbuqMXAHgN6GY9if5xP8dmtHFfwjuQAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 3 - use PyTorch to view tensor values</span>
<span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>tensor([[  0,   0,   0,   0,   0,   0],
        [  0,   0,   0,   0,   0,  29],
        [  0,   0,   0,  48, 166, 224],
        [  0,  93, 244, 249, 253, 187],
        [  0, 107, 253, 253, 230,  48],
        [  0,   3,  20,  20,  15,   0]], dtype=torch.uint8)</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 4 - Getting creative with Pandas</span>
<span class="n">im3_t</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">im3_t</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span><span class="s1">&#39;6pt&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
#T_71814984_fd78_11ea_966e_0242ac110002row0_col0,#T_71814984_fd78_11ea_966e_0242ac110002row0_col1,#T_71814984_fd78_11ea_966e_0242ac110002row0_col2,#T_71814984_fd78_11ea_966e_0242ac110002row0_col3,#T_71814984_fd78_11ea_966e_0242ac110002row0_col4,#T_71814984_fd78_11ea_966e_0242ac110002row0_col5,#T_71814984_fd78_11ea_966e_0242ac110002row0_col6,#T_71814984_fd78_11ea_966e_0242ac110002row0_col7,#T_71814984_fd78_11ea_966e_0242ac110002row0_col8,#T_71814984_fd78_11ea_966e_0242ac110002row0_col9,#T_71814984_fd78_11ea_966e_0242ac110002row0_col10,#T_71814984_fd78_11ea_966e_0242ac110002row0_col11,#T_71814984_fd78_11ea_966e_0242ac110002row0_col12,#T_71814984_fd78_11ea_966e_0242ac110002row0_col13,#T_71814984_fd78_11ea_966e_0242ac110002row0_col14,#T_71814984_fd78_11ea_966e_0242ac110002row0_col15,#T_71814984_fd78_11ea_966e_0242ac110002row0_col16,#T_71814984_fd78_11ea_966e_0242ac110002row0_col17,#T_71814984_fd78_11ea_966e_0242ac110002row1_col0,#T_71814984_fd78_11ea_966e_0242ac110002row1_col1,#T_71814984_fd78_11ea_966e_0242ac110002row1_col2,#T_71814984_fd78_11ea_966e_0242ac110002row1_col3,#T_71814984_fd78_11ea_966e_0242ac110002row1_col4,#T_71814984_fd78_11ea_966e_0242ac110002row1_col15,#T_71814984_fd78_11ea_966e_0242ac110002row1_col16,#T_71814984_fd78_11ea_966e_0242ac110002row1_col17,#T_71814984_fd78_11ea_966e_0242ac110002row2_col0,#T_71814984_fd78_11ea_966e_0242ac110002row2_col1,#T_71814984_fd78_11ea_966e_0242ac110002row2_col2,#T_71814984_fd78_11ea_966e_0242ac110002row2_col15,#T_71814984_fd78_11ea_966e_0242ac110002row2_col16,#T_71814984_fd78_11ea_966e_0242ac110002row2_col17,#T_71814984_fd78_11ea_966e_0242ac110002row3_col0,#T_71814984_fd78_11ea_966e_0242ac110002row3_col15,#T_71814984_fd78_11ea_966e_0242ac110002row3_col16,#T_71814984_fd78_11ea_966e_0242ac110002row3_col17,#T_71814984_fd78_11ea_966e_0242ac110002row4_col0,#T_71814984_fd78_11ea_966e_0242ac110002row4_col6,#T_71814984_fd78_11ea_966e_0242ac110002row4_col7,#T_71814984_fd78_11ea_966e_0242ac110002row4_col8,#T_71814984_fd78_11ea_966e_0242ac110002row4_col9,#T_71814984_fd78_11ea_966e_0242ac110002row4_col10,#T_71814984_fd78_11ea_966e_0242ac110002row4_col15,#T_71814984_fd78_11ea_966e_0242ac110002row4_col16,#T_71814984_fd78_11ea_966e_0242ac110002row4_col17,#T_71814984_fd78_11ea_966e_0242ac110002row5_col0,#T_71814984_fd78_11ea_966e_0242ac110002row5_col5,#T_71814984_fd78_11ea_966e_0242ac110002row5_col6,#T_71814984_fd78_11ea_966e_0242ac110002row5_col7,#T_71814984_fd78_11ea_966e_0242ac110002row5_col8,#T_71814984_fd78_11ea_966e_0242ac110002row5_col9,#T_71814984_fd78_11ea_966e_0242ac110002row5_col15,#T_71814984_fd78_11ea_966e_0242ac110002row5_col16,#T_71814984_fd78_11ea_966e_0242ac110002row5_col17,#T_71814984_fd78_11ea_966e_0242ac110002row6_col0,#T_71814984_fd78_11ea_966e_0242ac110002row6_col1,#T_71814984_fd78_11ea_966e_0242ac110002row6_col2,#T_71814984_fd78_11ea_966e_0242ac110002row6_col3,#T_71814984_fd78_11ea_966e_0242ac110002row6_col4,#T_71814984_fd78_11ea_966e_0242ac110002row6_col5,#T_71814984_fd78_11ea_966e_0242ac110002row6_col6,#T_71814984_fd78_11ea_966e_0242ac110002row6_col7,#T_71814984_fd78_11ea_966e_0242ac110002row6_col8,#T_71814984_fd78_11ea_966e_0242ac110002row6_col9,#T_71814984_fd78_11ea_966e_0242ac110002row6_col14,#T_71814984_fd78_11ea_966e_0242ac110002row6_col15,#T_71814984_fd78_11ea_966e_0242ac110002row6_col16,#T_71814984_fd78_11ea_966e_0242ac110002row6_col17,#T_71814984_fd78_11ea_966e_0242ac110002row7_col0,#T_71814984_fd78_11ea_966e_0242ac110002row7_col1,#T_71814984_fd78_11ea_966e_0242ac110002row7_col2,#T_71814984_fd78_11ea_966e_0242ac110002row7_col3,#T_71814984_fd78_11ea_966e_0242ac110002row7_col4,#T_71814984_fd78_11ea_966e_0242ac110002row7_col5,#T_71814984_fd78_11ea_966e_0242ac110002row7_col6,#T_71814984_fd78_11ea_966e_0242ac110002row7_col13,#T_71814984_fd78_11ea_966e_0242ac110002row7_col14,#T_71814984_fd78_11ea_966e_0242ac110002row7_col15,#T_71814984_fd78_11ea_966e_0242ac110002row7_col16,#T_71814984_fd78_11ea_966e_0242ac110002row7_col17,#T_71814984_fd78_11ea_966e_0242ac110002row8_col0,#T_71814984_fd78_11ea_966e_0242ac110002row8_col1,#T_71814984_fd78_11ea_966e_0242ac110002row8_col2,#T_71814984_fd78_11ea_966e_0242ac110002row8_col3,#T_71814984_fd78_11ea_966e_0242ac110002row8_col4,#T_71814984_fd78_11ea_966e_0242ac110002row8_col13,#T_71814984_fd78_11ea_966e_0242ac110002row8_col14,#T_71814984_fd78_11ea_966e_0242ac110002row8_col15,#T_71814984_fd78_11ea_966e_0242ac110002row8_col16,#T_71814984_fd78_11ea_966e_0242ac110002row8_col17,#T_71814984_fd78_11ea_966e_0242ac110002row9_col0,#T_71814984_fd78_11ea_966e_0242ac110002row9_col1,#T_71814984_fd78_11ea_966e_0242ac110002row9_col2,#T_71814984_fd78_11ea_966e_0242ac110002row9_col3,#T_71814984_fd78_11ea_966e_0242ac110002row9_col4,#T_71814984_fd78_11ea_966e_0242ac110002row9_col16,#T_71814984_fd78_11ea_966e_0242ac110002row9_col17,#T_71814984_fd78_11ea_966e_0242ac110002row10_col0,#T_71814984_fd78_11ea_966e_0242ac110002row10_col1,#T_71814984_fd78_11ea_966e_0242ac110002row10_col2,#T_71814984_fd78_11ea_966e_0242ac110002row10_col3,#T_71814984_fd78_11ea_966e_0242ac110002row10_col4,#T_71814984_fd78_11ea_966e_0242ac110002row10_col5,#T_71814984_fd78_11ea_966e_0242ac110002row10_col6,#T_71814984_fd78_11ea_966e_0242ac110002row10_col17{
            font-size:  6pt;
            background-color:  #ffffff;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col5{
            font-size:  6pt;
            background-color:  #efefef;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col6,#T_71814984_fd78_11ea_966e_0242ac110002row1_col13{
            font-size:  6pt;
            background-color:  #7c7c7c;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col7{
            font-size:  6pt;
            background-color:  #4a4a4a;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col8,#T_71814984_fd78_11ea_966e_0242ac110002row1_col9,#T_71814984_fd78_11ea_966e_0242ac110002row1_col10,#T_71814984_fd78_11ea_966e_0242ac110002row2_col5,#T_71814984_fd78_11ea_966e_0242ac110002row2_col6,#T_71814984_fd78_11ea_966e_0242ac110002row2_col7,#T_71814984_fd78_11ea_966e_0242ac110002row2_col11,#T_71814984_fd78_11ea_966e_0242ac110002row2_col12,#T_71814984_fd78_11ea_966e_0242ac110002row2_col13,#T_71814984_fd78_11ea_966e_0242ac110002row3_col4,#T_71814984_fd78_11ea_966e_0242ac110002row3_col12,#T_71814984_fd78_11ea_966e_0242ac110002row3_col13,#T_71814984_fd78_11ea_966e_0242ac110002row4_col1,#T_71814984_fd78_11ea_966e_0242ac110002row4_col2,#T_71814984_fd78_11ea_966e_0242ac110002row4_col3,#T_71814984_fd78_11ea_966e_0242ac110002row4_col12,#T_71814984_fd78_11ea_966e_0242ac110002row4_col13,#T_71814984_fd78_11ea_966e_0242ac110002row5_col12,#T_71814984_fd78_11ea_966e_0242ac110002row6_col11,#T_71814984_fd78_11ea_966e_0242ac110002row9_col11,#T_71814984_fd78_11ea_966e_0242ac110002row10_col11,#T_71814984_fd78_11ea_966e_0242ac110002row10_col12,#T_71814984_fd78_11ea_966e_0242ac110002row10_col13,#T_71814984_fd78_11ea_966e_0242ac110002row10_col14,#T_71814984_fd78_11ea_966e_0242ac110002row10_col15,#T_71814984_fd78_11ea_966e_0242ac110002row10_col16{
            font-size:  6pt;
            background-color:  #000000;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col11{
            font-size:  6pt;
            background-color:  #606060;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col12{
            font-size:  6pt;
            background-color:  #4d4d4d;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row1_col14{
            font-size:  6pt;
            background-color:  #bbbbbb;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row2_col3{
            font-size:  6pt;
            background-color:  #e4e4e4;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row2_col4,#T_71814984_fd78_11ea_966e_0242ac110002row8_col6{
            font-size:  6pt;
            background-color:  #6b6b6b;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row2_col8,#T_71814984_fd78_11ea_966e_0242ac110002row2_col14,#T_71814984_fd78_11ea_966e_0242ac110002row3_col14{
            font-size:  6pt;
            background-color:  #171717;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row2_col9,#T_71814984_fd78_11ea_966e_0242ac110002row3_col11{
            font-size:  6pt;
            background-color:  #4b4b4b;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row2_col10,#T_71814984_fd78_11ea_966e_0242ac110002row7_col10,#T_71814984_fd78_11ea_966e_0242ac110002row8_col8,#T_71814984_fd78_11ea_966e_0242ac110002row8_col10,#T_71814984_fd78_11ea_966e_0242ac110002row9_col8,#T_71814984_fd78_11ea_966e_0242ac110002row9_col10{
            font-size:  6pt;
            background-color:  #010101;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col1{
            font-size:  6pt;
            background-color:  #272727;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col2{
            font-size:  6pt;
            background-color:  #0a0a0a;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col3{
            font-size:  6pt;
            background-color:  #050505;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col5{
            font-size:  6pt;
            background-color:  #333333;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col6{
            font-size:  6pt;
            background-color:  #e6e6e6;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col7,#T_71814984_fd78_11ea_966e_0242ac110002row3_col10{
            font-size:  6pt;
            background-color:  #fafafa;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col8{
            font-size:  6pt;
            background-color:  #fbfbfb;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row3_col9{
            font-size:  6pt;
            background-color:  #fdfdfd;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row4_col4{
            font-size:  6pt;
            background-color:  #1b1b1b;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row4_col5{
            font-size:  6pt;
            background-color:  #e0e0e0;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row4_col11{
            font-size:  6pt;
            background-color:  #4e4e4e;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row4_col14{
            font-size:  6pt;
            background-color:  #767676;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col1{
            font-size:  6pt;
            background-color:  #fcfcfc;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col2,#T_71814984_fd78_11ea_966e_0242ac110002row5_col3{
            font-size:  6pt;
            background-color:  #f6f6f6;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col4,#T_71814984_fd78_11ea_966e_0242ac110002row7_col7{
            font-size:  6pt;
            background-color:  #f8f8f8;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col10,#T_71814984_fd78_11ea_966e_0242ac110002row10_col7{
            font-size:  6pt;
            background-color:  #e8e8e8;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col11{
            font-size:  6pt;
            background-color:  #222222;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col13,#T_71814984_fd78_11ea_966e_0242ac110002row6_col12{
            font-size:  6pt;
            background-color:  #090909;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row5_col14{
            font-size:  6pt;
            background-color:  #d0d0d0;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row6_col10,#T_71814984_fd78_11ea_966e_0242ac110002row7_col11,#T_71814984_fd78_11ea_966e_0242ac110002row9_col6{
            font-size:  6pt;
            background-color:  #060606;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row6_col13{
            font-size:  6pt;
            background-color:  #979797;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row7_col8{
            font-size:  6pt;
            background-color:  #b6b6b6;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row7_col9{
            font-size:  6pt;
            background-color:  #252525;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row7_col12{
            font-size:  6pt;
            background-color:  #999999;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row8_col5{
            font-size:  6pt;
            background-color:  #f9f9f9;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row8_col7{
            font-size:  6pt;
            background-color:  #101010;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row8_col9,#T_71814984_fd78_11ea_966e_0242ac110002row9_col9{
            font-size:  6pt;
            background-color:  #020202;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row8_col11{
            font-size:  6pt;
            background-color:  #545454;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row8_col12{
            font-size:  6pt;
            background-color:  #f1f1f1;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col5{
            font-size:  6pt;
            background-color:  #f7f7f7;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col7{
            font-size:  6pt;
            background-color:  #030303;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col12{
            font-size:  6pt;
            background-color:  #181818;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col13{
            font-size:  6pt;
            background-color:  #303030;
            color:  #f1f1f1;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col14{
            font-size:  6pt;
            background-color:  #a9a9a9;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row9_col15{
            font-size:  6pt;
            background-color:  #fefefe;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row10_col8,#T_71814984_fd78_11ea_966e_0242ac110002row10_col9{
            font-size:  6pt;
            background-color:  #bababa;
            color:  #000000;
        }#T_71814984_fd78_11ea_966e_0242ac110002row10_col10{
            font-size:  6pt;
            background-color:  #393939;
            color:  #f1f1f1;
        }</style><table id="T_71814984_fd78_11ea_966e_0242ac110002" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>        <th class="col_heading level0 col5" >5</th>        <th class="col_heading level0 col6" >6</th>        <th class="col_heading level0 col7" >7</th>        <th class="col_heading level0 col8" >8</th>        <th class="col_heading level0 col9" >9</th>        <th class="col_heading level0 col10" >10</th>        <th class="col_heading level0 col11" >11</th>        <th class="col_heading level0 col12" >12</th>        <th class="col_heading level0 col13" >13</th>        <th class="col_heading level0 col14" >14</th>        <th class="col_heading level0 col15" >15</th>        <th class="col_heading level0 col16" >16</th>        <th class="col_heading level0 col17" >17</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col0" class="data row0 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col1" class="data row0 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col2" class="data row0 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col3" class="data row0 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col4" class="data row0 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col5" class="data row0 col5" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col6" class="data row0 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col7" class="data row0 col7" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col8" class="data row0 col8" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col9" class="data row0 col9" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col10" class="data row0 col10" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col11" class="data row0 col11" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col12" class="data row0 col12" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col13" class="data row0 col13" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col14" class="data row0 col14" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col15" class="data row0 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col16" class="data row0 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row0_col17" class="data row0 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col0" class="data row1 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col1" class="data row1 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col2" class="data row1 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col3" class="data row1 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col4" class="data row1 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col5" class="data row1 col5" >29</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col6" class="data row1 col6" >150</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col7" class="data row1 col7" >195</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col8" class="data row1 col8" >254</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col9" class="data row1 col9" >255</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col10" class="data row1 col10" >254</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col11" class="data row1 col11" >176</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col12" class="data row1 col12" >193</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col13" class="data row1 col13" >150</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col14" class="data row1 col14" >96</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col15" class="data row1 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col16" class="data row1 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row1_col17" class="data row1 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col0" class="data row2 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col1" class="data row2 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col2" class="data row2 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col3" class="data row2 col3" >48</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col4" class="data row2 col4" >166</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col5" class="data row2 col5" >224</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col6" class="data row2 col6" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col7" class="data row2 col7" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col8" class="data row2 col8" >234</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col9" class="data row2 col9" >196</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col10" class="data row2 col10" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col11" class="data row2 col11" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col12" class="data row2 col12" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col13" class="data row2 col13" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col14" class="data row2 col14" >233</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col15" class="data row2 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col16" class="data row2 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row2_col17" class="data row2 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col0" class="data row3 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col1" class="data row3 col1" >93</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col2" class="data row3 col2" >244</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col3" class="data row3 col3" >249</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col4" class="data row3 col4" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col5" class="data row3 col5" >187</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col6" class="data row3 col6" >46</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col7" class="data row3 col7" >10</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col8" class="data row3 col8" >8</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col9" class="data row3 col9" >4</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col10" class="data row3 col10" >10</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col11" class="data row3 col11" >194</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col12" class="data row3 col12" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col13" class="data row3 col13" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col14" class="data row3 col14" >233</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col15" class="data row3 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col16" class="data row3 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row3_col17" class="data row3 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col0" class="data row4 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col1" class="data row4 col1" >107</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col2" class="data row4 col2" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col3" class="data row4 col3" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col4" class="data row4 col4" >230</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col5" class="data row4 col5" >48</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col6" class="data row4 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col7" class="data row4 col7" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col8" class="data row4 col8" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col9" class="data row4 col9" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col10" class="data row4 col10" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col11" class="data row4 col11" >192</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col12" class="data row4 col12" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col13" class="data row4 col13" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col14" class="data row4 col14" >156</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col15" class="data row4 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col16" class="data row4 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row4_col17" class="data row4 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col0" class="data row5 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col1" class="data row5 col1" >3</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col2" class="data row5 col2" >20</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col3" class="data row5 col3" >20</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col4" class="data row5 col4" >15</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col5" class="data row5 col5" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col6" class="data row5 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col7" class="data row5 col7" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col8" class="data row5 col8" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col9" class="data row5 col9" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col10" class="data row5 col10" >43</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col11" class="data row5 col11" >224</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col12" class="data row5 col12" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col13" class="data row5 col13" >245</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col14" class="data row5 col14" >74</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col15" class="data row5 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col16" class="data row5 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row5_col17" class="data row5 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col0" class="data row6 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col1" class="data row6 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col2" class="data row6 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col3" class="data row6 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col4" class="data row6 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col5" class="data row6 col5" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col6" class="data row6 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col7" class="data row6 col7" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col8" class="data row6 col8" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col9" class="data row6 col9" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col10" class="data row6 col10" >249</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col11" class="data row6 col11" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col12" class="data row6 col12" >245</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col13" class="data row6 col13" >126</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col14" class="data row6 col14" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col15" class="data row6 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col16" class="data row6 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row6_col17" class="data row6 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row7" class="row_heading level0 row7" >7</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col0" class="data row7 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col1" class="data row7 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col2" class="data row7 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col3" class="data row7 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col4" class="data row7 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col5" class="data row7 col5" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col6" class="data row7 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col7" class="data row7 col7" >14</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col8" class="data row7 col8" >101</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col9" class="data row7 col9" >223</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col10" class="data row7 col10" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col11" class="data row7 col11" >248</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col12" class="data row7 col12" >124</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col13" class="data row7 col13" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col14" class="data row7 col14" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col15" class="data row7 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col16" class="data row7 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row7_col17" class="data row7 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row8" class="row_heading level0 row8" >8</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col0" class="data row8 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col1" class="data row8 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col2" class="data row8 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col3" class="data row8 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col4" class="data row8 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col5" class="data row8 col5" >11</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col6" class="data row8 col6" >166</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col7" class="data row8 col7" >239</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col8" class="data row8 col8" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col9" class="data row8 col9" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col10" class="data row8 col10" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col11" class="data row8 col11" >187</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col12" class="data row8 col12" >30</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col13" class="data row8 col13" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col14" class="data row8 col14" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col15" class="data row8 col15" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col16" class="data row8 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row8_col17" class="data row8 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row9" class="row_heading level0 row9" >9</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col0" class="data row9 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col1" class="data row9 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col2" class="data row9 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col3" class="data row9 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col4" class="data row9 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col5" class="data row9 col5" >16</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col6" class="data row9 col6" >248</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col7" class="data row9 col7" >250</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col8" class="data row9 col8" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col9" class="data row9 col9" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col10" class="data row9 col10" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col11" class="data row9 col11" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col12" class="data row9 col12" >232</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col13" class="data row9 col13" >213</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col14" class="data row9 col14" >111</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col15" class="data row9 col15" >2</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col16" class="data row9 col16" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row9_col17" class="data row9 col17" >0</td>
            </tr>
            <tr>
                        <th id="T_71814984_fd78_11ea_966e_0242ac110002level0_row10" class="row_heading level0 row10" >10</th>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col0" class="data row10 col0" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col1" class="data row10 col1" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col2" class="data row10 col2" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col3" class="data row10 col3" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col4" class="data row10 col4" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col5" class="data row10 col5" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col6" class="data row10 col6" >0</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col7" class="data row10 col7" >43</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col8" class="data row10 col8" >98</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col9" class="data row10 col9" >98</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col10" class="data row10 col10" >208</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col11" class="data row10 col11" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col12" class="data row10 col12" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col13" class="data row10 col13" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col14" class="data row10 col14" >253</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col15" class="data row10 col15" >187</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col16" class="data row10 col16" >22</td>
                        <td id="T_71814984_fd78_11ea_966e_0242ac110002row10_col17" class="data row10 col17" >0</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="sidebar-think-about-the-problem">Sidebar - think about the problem</h3>
<p>Before jumping into solution mode (ie apply deep learning to everything!) think about the problem space and how you might be able to solve it. </p>
<p>For this problem (digit recognition) using a simple average might be enough to get a descent result. That is exactly what we will do first.
</div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="method-1-pixel-similarity">Method 1: Pixel Similarity</h1>
<ul>
<li>find the average pixel value for every pixel of the 3s and 7s<ul>
<li>this will give us 2 group averages that represent the "ideal" 3 and 7</li>
</ul>
</li>
<li>to classify a digit, check the similarity against the ideal</li>
<li>this method will form our baseline that we will improve upon later</li>
</ul>
<h3 id="step-1-organise-data">Step 1: Organise data</h3>
<ul>
<li>create a tensor by stacking all of our 3s together<ul>
<li>we will use list comprehension for this
</div>
</div></li>
</ul>
</li>
</ul>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># open all images, convert to tensor, store in list</span>

<span class="n">seven_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sevens</span><span class="p">]</span>
<span class="n">three_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">threes</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(6131, 6265)</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># lets check one of</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="step-2-compute-the-average-pixel-value">Step 2: Compute the average pixel value</h3>
<ul>
<li>For every pixel position, compute the average over all the images of the intensity of that pixel.</li>
<li>To do this<ul>
<li>combine all images into a single 3-dimensional tensor using <a href="https://pytorch.org/docs/stable/generated/torch.stack.html"><code>stack</code></a> which  "<em>Concatenates sequence of tensors along a new dimension</em>."</li>
<li>PuyTorch needs us to cast the <code>int</code> values to floats in order to compute the average.</li>
<li>"Generally when images are floats, the pixel values are expected to be between 0 and 1, so we will also divide by 255 here" <a href="https://github.com/fastai/fastbook/blob/master/04_mnist_basics.ipynb">source</a>
</div>
</div></li>
</ul>
</li>
</ul>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>torch.Size([6131, 28, 28])</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
<code>tensor</code> jargon
- <em>rank</em>: the number of axis
- <em>shape</em>: the size of each axis
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

</div>
</div>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rank:&#39;</span><span class="p">,</span><span class="n">stacked_threes</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
      <span class="s1">&#39;shape:&#39;</span><span class="p">,</span> <span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>rank: 3 
 shape: torch.Size([6131, 28, 28])
</code>
</pre>
</div>
</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
We have 6,131 images of size 28x28 
</div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="step-3-compute-the-ideal-digits">Step 3: Compute the ideal digits</h3>
<ul>
<li>compute the mean along the 0th dimension</li>
<li>by visualising this ideal 3 we can indeed see that it represents a 3!
</div>
</div></li>
</ul>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">mean3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean3</span><span class="p">);</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">mean7</span> <span class="o">=</span> <span class="n">stacked_sevens</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean7</span><span class="p">);</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># here is a random three for comparison</span>
<span class="n">a_3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">a_3</span><span class="p">);</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
How could we calculate how similar a 3 is from this ideal 3? Typically there are two methods</p>
<ul>
<li>take the absolute value of differences (where there are negatives, replace with postive)<ul>
<li>This is called the <em>mean absolute difference</em> or <em>L1 norm</em></li>
</ul>
</li>
<li>take the mean squared difference (which also makes all results positive) then take the square root<ul>
<li>This is called the <em>root mean squared error (RMSE)</em> or <em>L2 norm</em>.</li>
</ul>
</li>
</ul>
</div>
</div>


</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 3</span>
<span class="c1"># L1 Norm</span>
<span class="c1"># mean absolute difference</span>

<span class="n">dist_3_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_3_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_3_abs</span><span class="p">,</span> <span class="n">dist_3_sqr</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor(0.1114), tensor(0.2021))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># 7</span>
<span class="c1"># L1 Norm</span>
<span class="c1"># mean absolute difference</span>

<span class="n">dist_3_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_3_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_3_abs</span><span class="p">,</span> <span class="n">dist_3_sqr</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor(0.1586), tensor(0.3021))</code>
</pre>
</div>

</div>

</div>
</div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
The distance between our "ideal" 3 and the real 3 is less than the distance from the real 3 to "ideal" 7. This is good - it means both methods will work and our simple model will give the correct prediction.</p>
<p>PyTorch already provides these loss functions for us (though RMSE is only MSE, but we can work with that).
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># check results with PyTorch</span>

<span class="n">F</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">a_3</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">mean7</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span><span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor(0.1586), tensor(0.3021))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="a-simple-model">A simple model</h3>
<p>A validation set is usually used to help avoid overfitting, our model has no trained components so this isn't going to be an issue, but let's stick with best practices.</p>
<p>We will also define a function that will decide if an arbitrary image is a 3 or a 7. This will be achieved by measuring the distance between this digit and our ideal digits and determining which ideal it is closer to. </p>
</div>
</div>
</div>
</div>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">valid_3_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">valid_7_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_3_tens</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">valid_7_tens</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(torch.Size([1010, 28, 28]), torch.Size([1028, 28, 28]))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
<code>mnist_distance</code> calculates the difference between our ideal 3 and every 3 in the validation set.</p>
<p>We call <code>mean((-1,-2))</code> in our fuction. The tuple <code>(-1,-2)</code> represents a range of axes, so the last -1, and second last -2. <code>mean((-1,-2))</code> says; take the mean over the last two axes in the tensor. Why? These axes represent the verticle and horizontal dimensions of an image. After taking the mean over the these axes, we have one axis left which indexes over the 1,010 images we have. 
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered"></div>
</div>
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># calculate the mean absolute error</span>

<span class="k">def</span> <span class="nf">mnist_distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># check the function</span>
<span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span> <span class="c1"># great!</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>tensor(0.1114)</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
This works for a single image, but in order to calculate the overall accuracy, we want to calculate this distance to the ideal 3 for all images in the validation set. This can be achieved using a loop, but there is another way - broadcasting.</p>
<p>Take a look at the shape of <code>valid_3_tens</code> and <code>mean3</code>, they are different...
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="n">valid_3_tens</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">mean3</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(torch.Size([1010, 28, 28]), torch.Size([28, 28]))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Now calculate the distance between the two...
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

</div>
</div>
<div class="codehilite"><pre><span></span><code><span class="n">valid_3_dist</span> <span class="o">=</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span>

<span class="n">valid_3_dist</span><span class="p">,</span> <span class="n">valid_3_dist</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor([0.1290, 0.1223, 0.1380,  ..., 0.1337, 0.1132, 0.1097]),
 torch.Size([1010]))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
our function has returned the distance for every single image as a rank-1 tensor of length 1,010.</p>
<p>This is because we have added a subtraction <code>(a-b)</code> into our distance function and when PyTorch performs this subtraction, it uses <em>broadcasting</em> which will automatically expand the tensor with smaller rank to have the same size as the one with larger rank. Once this has happened, PyTorch will perform an element wise operation over the two tensors. </p>
<p>In our case, PyTorch is treating <code>mean3</code> (a rank 2 tensor) as if it were 1,010 copies of that tensor.</p>
<p>You can see that by performing a subtraction and checking the shape
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">valid_3_tens</span><span class="o">-</span><span class="n">mean3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>torch.Size([1010, 28, 28])</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
There are a couple of important points about how broadcasting is implemented, which make it valuable not just for expressivity but also for performance:</p>
<ul>
<li>PyTorch doesn't actually copy mean3 1,010 times. It pretends it were a tensor of that shape, but doesn't actually allocate any additional memory</li>
<li>It does the whole calculation in C (or, if you're using a GPU, in CUDA, the equivalent of C on the GPU), tens of thousands of times faster than pure Python (up to millions of times faster on a GPU!).</li>
</ul>
<p><a href="https://github.com/fastai/fastbook/blob/master/04_mnist_basics.ipynb">source</a>
</div>
</div></p>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="a-funtion-to-make-a-decision">A funtion to make a decision</h3>
<p><code>is_3</code> is going to use <code>mnist_distance</code> to figure out whether an image is a 3 or a 7. To do this it will check whether the distance between a digit, x and <code>mean3</code> is less than the difference between x and <code>mean7</code>.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean7</span><span class="p">)</span>
</code></pre></div>


</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="codehilite"><pre><span></span><code><span class="c1"># let&#39;s test it</span>
<span class="c1"># you can convert a boolean to a float </span>

<span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">),</span> <span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor(True), tensor(1.))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Calculate the accuracy for each 3 and 7 by taking the average of <code>is_3</code> for all 3s and it's inverse for all 7s. 
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

</div>
</div>
<div class="codehilite"><pre><span></span><code><span class="n">accuracy_3s</span> <span class="o">=</span>      <span class="n">is_3</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">accuracy_7s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">is_3</span><span class="p">(</span><span class="n">valid_7_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">accuracy_3s</span><span class="p">,</span> <span class="n">accuracy_7s</span><span class="p">,</span> <span class="p">(</span><span class="n">accuracy_3s</span><span class="o">+</span><span class="n">accuracy_7s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</code></pre></div>


</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>
<code>(tensor(0.9168), tensor(0.9854), tensor(0.9511))</code>
</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Not bad, over 90% accuracy using a very simple model. This was also a very simple problem, 3s and 7s look very different so it's not really a surprise that this was so effective.</p>
<p>We will nowe look at a system that will do some learning (automatically modify itself to improve its performance)</p>
<p>In the next part, we will implement this more advanced model
</div>
</div></p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../lesson%2002/" title="Lesson 02" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Lesson 02
              </div>
            </div>
          </a>
        
        
          <a href="../lesson%2003%20pt%202/" title="Lesson 03 pt 2" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Lesson 03 pt 2
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2020 Devin de Araujo
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/devindearaujo/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>